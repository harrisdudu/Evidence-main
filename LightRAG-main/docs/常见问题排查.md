# 常见问题排查清单

## 1. 服务起不来

- 端口占用：检查 `9621`（后端）与 `5173`（WebUI dev）
  - PowerShell：`Get-NetTCPConnection -LocalPort 9621`
- `.env` 未生效：后端只会读取“启动目录”的 `.env`
  - 建议始终在仓库根目录执行启动脚本
  - 修改 `.env` 后重新开一个终端再启动
- 依赖未安装/环境不匹配
  - 后端：确认 `uv` 可用，执行 `uv sync --extra api`
  - 前端：确认 `bun` 可用，执行 `bun install --frozen-lockfile`

## 2. 打开页面但 UI 为空/404

- 访问路径错误
  - 后端挂载模式：访问 `http://localhost:9621/webui`
  - WebUI dev：访问 `http://localhost:5173/webui/`
- WebUI 未 build（后端挂载模式）
  - 需要在 `lightrag_webui` 执行 `bun run build`
  - 构建输出会写入 `lightrag/api/webui`

## 3. API 访问报 401/403

- API-Key 模式：若设置了 `LIGHTRAG_API_KEY`，请求必须带 `X-API-Key`
- 登录/JWT 模式：若配置了 `AUTH_ACCOUNTS`，需要先 `/login` 获取 token
- 白名单路径：`WHITELIST_PATHS` 默认包含 `/health`

## 4. 跨域（CORS）问题

- WebUI dev 默认通过代理访问后端，通常不会触发 CORS
- 若你在其它域名/端口直接访问 API，需要设置：
  - `.env`：`CORS_ORIGINS=http://localhost:3000,http://localhost:5173`
  - 或直接设置为 `*`（仅建议开发环境）

## 5. 数据库存储连接失败

- 检查你选择的存储实现是否与对应连接参数匹配
  - 选择项与示例：[`env.example`](file:///e:/OPC-ZCKJ/LightRAG-main/LightRAG-main/env.example#L361-L500)
- 常见端口
  - Postgres 5432 / Neo4j 7687 / Redis 6379 / Milvus 19530 / Qdrant 6333 / Mongo 27017
- 生产建议
  - Postgres/Redis/Neo4j 等请先保证实例可连通，再启动 LightRAG
  - Docker 场景下，连接本机服务需用 `host.docker.internal` 替代 `localhost`

## 6. 健康检查与日志定位

- 健康检查：`GET /health`
  - 若返回 500，说明后端初始化（存储/配置）失败，可直接查看启动控制台日志
- 日志级别
  - `.env`：`LOG_LEVEL=DEBUG|INFO|...`
  - 启动参数：`lightrag-server --log-level DEBUG`

